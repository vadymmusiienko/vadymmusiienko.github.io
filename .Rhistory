summarise(avr_price = mean(price), avr_points = mean(points)) |>
ggplot(aes(avr_price, avr_points)) +
geom_point(size = 3) +
geom_label_repel(aes(label = adjective),
size = 2.5, color = "black", fill = "lightblue",
label.size = 0.25) +
theme_minimal()
wine_with_adj |> group_by(adjective) |>
summarise(avr_price = mean(price), avr_points = mean(points)) |>
ggplot(aes(avr_price, avr_points)) +
geom_point(size = 3) +
geom_label_repel(aes(label = adjective),
size = 2.5, color = "black", fill = "lightblue",
label.size = 0.25, label.padding = 0.5) +
theme_minimal()
wine_with_adj |> group_by(adjective) |>
summarise(avr_price = mean(price), avr_points = mean(points)) |>
ggplot(aes(avr_price, avr_points)) +
geom_point(size = 3) +
geom_label_repel(aes(label = adjective),
size = 2.5, color = "black", fill = "lightblue",
label.size = 0.25, label.padding = 0.05) +
theme_minimal()
wine_with_adj |> group_by(adjective) |>
summarise(avr_price = mean(price), avr_points = mean(points)) |>
ggplot(aes(avr_price, avr_points)) +
geom_point(size = 3) +
geom_label_repel(aes(label = adjective),
size = 2.5, color = "black", fill = "lightblue",
label.size = 0.25, label.padding = 0.15) +
theme_minimal()
wine_with_adj |> group_by(adjective) |>
summarise(avr_price = mean(price), avr_points = mean(points)) |>
ggplot(aes(avr_price, avr_points)) +
geom_point(size = 3) +
geom_label_repel(aes(label = adjective),
size = 2.5, color = "black", fill = "lightblue",
label.size = 0.25, label.padding = 0.20) +
theme_minimal()
wine_with_adj |> group_by(adjective) |>
summarise(avr_price = mean(price), avr_points = mean(points)) |>
ggplot(aes(avr_price, avr_points)) +
geom_point(size = 3) +
geom_label_repel(aes(label = adjective),
size = 2.5, color = "black", fill = "lightblue",
label.size = 0.25, label.padding = 0.25) +
theme_minimal()
wine_with_adj |> group_by(adjective) |>
summarise(avr_price = mean(price), avr_points = mean(points)) |>
ggplot(aes(avr_price, avr_points)) +
geom_point(size = 3) +
geom_label_repel(aes(label = adjective),
size = 2.5, color = "black", fill = "lightblue",
label.size = 0.25, label.padding = 0.25,
arrow = arrow(length = unit(0.1, "inches"))) +
theme_minimal()
wine_with_adj |> group_by(adjective) |>
summarise(avr_price = mean(price), avr_points = mean(points)) |>
ggplot(aes(avr_price, avr_points)) +
geom_point(size = 3) +
geom_label_repel(aes(label = adjective),
size = 2.5, color = "black", fill = "lightblue",
label.size = 0.25, label.padding = 0.25,
segment.color = "grey") +
theme_minimal()
wine_with_adj |> group_by(adjective) |>
summarise(avr_price = mean(price), avr_points = mean(points)) |>
ggplot(aes(avr_price, avr_points)) +
geom_point(size = 3) +
geom_label_repel(aes(label = adjective),
size = 2.5, color = "black", fill = "lightblue",
label.size = 0.25, label.padding = 0.25,
segment.color = "black") +
theme_minimal()
wine_with_adj |> group_by(adjective) |>
summarise(avr_price = mean(price), avr_points = mean(points)) |>
ggplot(aes(avr_price, avr_points)) +
geom_point(size = 3) +
geom_label_repel(aes(label = adjective),
size = 2.5, color = "black", fill = "lightblue",
label.size = 0.25, label.padding = 0.25,
) +
theme_minimal()
segment.color = "black"
wine_with_adj |> group_by(adjective) |>
summarise(avr_price = mean(price), avr_points = mean(points)) |>
ggplot(aes(avr_price, avr_points)) +
geom_point(size = 3) +
geom_label_repel(aes(label = adjective),
size = 2.5, color = "black", fill = "lightblue",
label.size = 0.25, label.padding = 0.25,
segment.color = "black") +
theme_minimal()
wine_with_adj |> group_by(adjective) |>
summarise(avr_price = mean(price), avr_points = mean(points)) |>
ggplot(aes(avr_price, avr_points)) +
geom_point(size = 3) +
geom_label_repel(aes(label = adjective),
size = 2.5, color = "black", fill = "lightblue",
label.size = 0.25, label.padding = 0.25,
segment.color = "red") +
theme_minimal()
wine_with_adj |> group_by(adjective) |>
summarise(avr_price = mean(price), avr_points = mean(points)) |>
ggplot(aes(avr_price, avr_points)) +
geom_point(size = 3) +
geom_label_repel(aes(label = adjective),
size = 2.5, color = "black", fill = "lightblue",
label.size = 0.25, label.padding = 0.25,
segment.color = "lightgrey") +
theme_minimal()
wine_with_adj |> group_by(adjective) |>
summarise(avr_price = mean(price), avr_points = mean(points)) |>
ggplot(aes(avr_price, avr_points)) +
geom_point(size = 3) +
geom_label_repel(aes(label = adjective),
size = 2.5, fill = "lightblue",
label.size = 0.25, label.padding = 0.25,
segment.color = "lightgrey", color = "black") +
theme_minimal()
wine_with_adj |> group_by(adjective) |>
summarise(avr_price = mean(price), avr_points = mean(points)) |>
ggplot(aes(avr_price, avr_points)) +
geom_point(size = 3) +
geom_label_repel(aes(label = adjective),
size = 2.5, color = "black", fill = "lightblue",
label.size = 0.25, label.padding = 0.25,
segment.color = "lightgrey") +
theme_minimal()
wine_with_adj |> group_by(adjective) |>
summarise(avr_price = mean(price), avr_points = mean(points)) |>
ggplot(aes(avr_price, avr_points)) +
geom_point(size = 3) +
geom_label_repel(aes(label = adjective),
size = 2.5, color = "black", fill = "lightblue",
label.size = 0.25, label.padding = 0.25,
segment.color = "lightgrey", box.padding = 0.25)) +
wine_with_adj |> group_by(adjective) |>
summarise(avr_price = mean(price), avr_points = mean(points)) |>
ggplot(aes(avr_price, avr_points)) +
geom_point(size = 3) +
geom_label_repel(aes(label = adjective),
size = 2.5, color = "black", fill = "lightblue",
label.size = 0.25, label.padding = 0.25,
segment.color = "lightgrey", box.padding = 0.25)) +
wine_with_adj |> group_by(adjective) |>
summarise(avr_price = mean(price), avr_points = mean(points)) |>
ggplot(aes(avr_price, avr_points)) +
geom_point(size = 3) +
geom_label_repel(aes(label = adjective),
size = 2.5, color = "black", fill = "lightblue",
label.size = 0.25, label.padding = 0.25,
segment.color = "lightgrey", box.padding = 0.25)) +
wine_with_adj |> group_by(adjective) |>
summarise(avr_price = mean(price), avr_points = mean(points)) |>
ggplot(aes(avr_price, avr_points)) +
geom_point(size = 3) +
geom_label_repel(aes(label = adjective),
size = 2.5, color = "black", fill = "lightblue",
label.size = 0.25, label.padding = 0.25,
segment.color = "lightgrey", box.padding = 0.25) +
theme_minimal()
wine_with_adj |> group_by(adjective) |>
summarise(avr_price = mean(price), avr_points = mean(points)) |>
ggplot(aes(avr_price, avr_points)) +
geom_point(size = 3) +
geom_label_repel(aes(label = adjective),
size = 2.5, color = "black", fill = "lightblue",
label.size = 0.25, label.padding = 0.25,
segment.color = "lightgrey", box.padding = 0.5) +
theme_minimal()
wine_with_adj |> group_by(adjective) |>
summarise(avr_price = mean(price), avr_points = mean(points)) |>
ggplot(aes(avr_price, avr_points)) +
geom_point(size = 3) +
geom_label_repel(aes(label = adjective),
size = 2.5, color = "black", fill = "lightblue",
label.size = 0.25, label.padding = 0.25,
segment.color = "lightgrey", box.padding = 0.25) +
theme_minimal()
wine_with_adj |> group_by(adjective) |>
summarise(avr_price = mean(price), avr_points = mean(points)) |>
ggplot(aes(avr_price, avr_points)) +
geom_point(size = 3) +
geom_label_repel(aes(label = adjective),
size = 2.5, color = "black", fill = "lightyellow",
label.size = 0.25, label.padding = 0.25,
segment.color = "lightgrey", box.padding = 0.25) +
theme_minimal()
wine_with_adj |> group_by(adjective) |>
summarise(avr_price = mean(price), avr_points = mean(points)) |>
ggplot(aes(avr_price, avr_points)) +
geom_point(size = 3) +
geom_label_repel(aes(label = adjective),
size = 2.5, color = "black", fill = "lightyellow",
label.size = 0.25, label.padding = 0.25,
segment.color = "grey", box.padding = 0.25) +
theme_minimal()
wine_with_adj |> group_by(adjective) |>
summarise(avr_price = mean(price), avr_points = mean(points)) |>
ggplot(aes(avr_price, avr_points)) +
geom_point(size = 3) +
geom_label_repel(aes(label = adjective),
size = 2.5, color = "black", fill = "lightyellow",
label.size = 0.25, label.padding = 0.25,
box.padding = 0.25) +
theme_minimal()
wine_with_adj |> group_by(adjective) |>
summarise(avr_price = mean(price), avr_points = mean(points)) |>
ggplot(aes(avr_price, avr_points)) +
geom_point(size = 3) +
geom_label_repel(aes(label = adjective),
size = 2.5, color = "black", fill = "lightyellow",
label.size = 0.25, label.padding = 0.25,
box.padding = 0.25) +
labs(
title = "Average price and rating of wine described with the adjective",
x = "Price",
y = "Points"
) +
theme_minimal()
slice_head(wine_data, n = 10)
## Inspect the variables
# Get rid of the rows where price or country is unknown and make char factor
wine_data <- wine_data |> filter(!(is.na(price) | is.na(country))) |>
mutate(country = as.factor(country)) |>
select(-c(region_1, region_2, winery))
wine_data
country_price <- wine_data |>
group_by(country) |>
summarize(avr_price = mean(price))
country_price |>
arrange(desc(avr_price)) |>
ggplot(aes(fct_reorder(country, avr_price, .desc = TRUE), avr_price,
fill = country)) +
geom_col(color = "black", width = 0.8, show.legend = FALSE) +
labs(
title = "Average price of wine",
x = NULL,
y = "Price in USD"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
country_price |>
ggplot(aes(fct_reorder(country, avr_price, .desc = TRUE), avr_price,
fill = country)) +
geom_col(color = "black", width = 0.8, show.legend = FALSE) +
labs(
title = "Average price of wine",
x = NULL,
y = "Price in USD"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
wine_data |>
group_by(country) |>
summarize(avr_price = mean(price)) |>
ggplot(aes(fct_reorder(country, avr_price, .desc = TRUE), avr_price,
fill = country)) +
geom_col(color = "black", width = 0.8, show.legend = FALSE) +
labs(
title = "Average price of wine",
x = NULL,
y = "Price in USD"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
wine_data |>
group_by(country) |>
summarize(avr_price = mean(price)) |>
ggplot(aes(fct_reorder(country, avr_price, .desc = TRUE), avr_price,
fill = country)) +
geom_col(color = "black", width = 0.8, show.legend = FALSE) +
labs(
title = "Average price of wine",
x = NULL,
y = "Price in USD"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.8, hjust=1))
wine_data |>
group_by(country) |>
summarize(avr_price = mean(price)) |>
ggplot(aes(fct_reorder(country, avr_price, .desc = TRUE), avr_price,
fill = country)) +
geom_col(color = "black", width = 0.8, show.legend = FALSE) +
labs(
title = "Average price of wine",
x = NULL,
y = "Price in USD"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, vjust = 1, hjust=1))
wine_data |>
group_by(country) |>
summarize(avr_price = mean(price)) |>
ggplot(aes(fct_reorder(country, avr_price, .desc = TRUE), avr_price,
fill = country)) +
geom_col(color = "black", width = 0.8, show.legend = FALSE) +
labs(
title = "Average price of wine",
x = NULL,
y = "Price in USD"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, vjust = 2, hjust=1))
wine_data |>
group_by(country) |>
summarize(avr_price = mean(price)) |>
ggplot(aes(fct_reorder(country, avr_price, .desc = TRUE), avr_price,
fill = country)) +
geom_col(color = "black", width = 0.8, show.legend = FALSE) +
labs(
title = "Average price of wine",
x = NULL,
y = "Price in USD"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, vjust = 10, hjust=1))
wine_data |>
group_by(country) |>
summarize(avr_price = mean(price)) |>
ggplot(aes(fct_reorder(country, avr_price, .desc = TRUE), avr_price,
fill = country)) +
geom_col(color = "black", width = 0.8, show.legend = FALSE) +
labs(
title = "Average price of wine",
x = NULL,
y = "Price in USD"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.1, hjust=1))
wine_data |>
group_by(country) |>
summarize(avr_price = mean(price)) |>
ggplot(aes(fct_reorder(country, avr_price, .desc = TRUE), avr_price,
fill = country)) +
geom_col(color = "black", width = 0.8, show.legend = FALSE) +
labs(
title = "Average price of wine",
x = NULL,
y = "Price in USD"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust=1))
wine_data |>
group_by(country) |>
summarize(avr_price = mean(price)) |>
ggplot(aes(fct_reorder(country, avr_price, .desc = TRUE), avr_price,
fill = country)) +
geom_col(color = "black", width = 0.8, show.legend = FALSE) +
labs(
title = "Average price of wine",
x = NULL,
y = "Price in USD"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust=2))
wine_data |>
group_by(country) |>
summarize(avr_price = mean(price)) |>
ggplot(aes(fct_reorder(country, avr_price, .desc = TRUE), avr_price,
fill = country)) +
geom_col(color = "black", width = 0.8, show.legend = FALSE) +
labs(
title = "Average price of wine",
x = NULL,
y = "Price in USD"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust=0.5))
wine_data |>
group_by(country) |>
summarize(avr_price = mean(price)) |>
ggplot(aes(fct_reorder(country, avr_price, .desc = TRUE), avr_price,
fill = country)) +
geom_col(color = "black", width = 0.8, show.legend = FALSE) +
labs(
title = "Average price of wine",
x = NULL,
y = "Price in USD"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust=1.2))
wine_data |>
group_by(country) |>
summarize(avr_price = mean(price)) |>
ggplot(aes(fct_reorder(country, avr_price, .desc = TRUE), avr_price,
fill = country)) +
geom_col(color = "black", width = 0.8, show.legend = FALSE) +
labs(
title = "Average price of wine",
x = NULL,
y = "Price in USD"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust=1.1))
wine_data |>
group_by(country) |>
summarize(avr_price = mean(price)) |>
ggplot(aes(fct_reorder(country, avr_price, .desc = TRUE), avr_price,
fill = country)) +
geom_col(color = "black", width = 0.8, show.legend = FALSE) +
labs(
title = "Average price of wine",
x = NULL,
y = "Price in USD"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust=1))
wine_data |>
group_by(country) |>
summarize(avr_price = mean(price)) |>
ggplot(aes(fct_reorder(country, avr_price, .desc = TRUE), avr_price,
fill = country)) +
geom_col(color = "black", width = 0.8, show.legend = FALSE) +
labs(
title = "Average price of wine",
x = NULL,
y = "Price in USD"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90))
wine_data
wine_data |>
filter(price < 500) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_point(alpha = 0.5) +
geom_smooth(color = "red") +
theme_minimal()
wine_data |>
filter(price < 500) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_point(alpha = 0.5) +
geom_smooth(color = "red") +
labs(
title = "Price vs Quality",
x = "Price (USD)",
y = "Average rating"
) +
theme_minimal()
### Berry notes
# Create a vector with the adjectives
adjectives <- c("Acidic", "Astringent", "Barnyard", "Buttery", "Chewy",
"Earthy", "Flabby", "Fruity", "Fruit-forward",
"Herbaceous", "Jammy", "Juicy", "Musty", "Nutty",
"Oaky", "Opulent", "Perfumed", "Racy", "Spicy",
"Supple", "Tannic", "Toasty", "Vegetal", "Velvety")
# Create a regex pattern to search for adjectives
pattern <- paste0("(?i)", paste(adjectives, collapse = "|"))
# Create a data frame with wine reviews where those adjectives were used
wine_with_adj <- wine_data |>
mutate(
adjective = factor(tolower(str_extract(description, pattern)))
) |>
filter(!is.na(adjective))
# Plot the frequency of each adjective
wine_with_adj |> group_by(adjective) |>
summarise(count = n()) |>
ggplot(count, aes(fct_reorder(adjective, count, .desc = TRUE),
fill = adjective)) +
geom_col(color = "black", width = 0.8, show.legend = FALSE) +
labs(
title = "Adjective frequency",
y = "Number of reviews",
x = NULL
) +
theme_minimal()
# Create a vector with the adjectives
adjectives <- c("Acidic", "Astringent", "Barnyard", "Buttery", "Chewy",
"Earthy", "Flabby", "Fruity", "Fruit-forward",
"Herbaceous", "Jammy", "Juicy", "Musty", "Nutty",
"Oaky", "Opulent", "Perfumed", "Racy", "Spicy",
"Supple", "Tannic", "Toasty", "Vegetal", "Velvety")
# Create a regex pattern to search for adjectives
pattern <- paste0("(?i)", paste(adjectives, collapse = "|"))
# Create a data frame with wine reviews where those adjectives were used
wine_with_adj <- wine_data |>
mutate(
adjective = factor(tolower(str_extract(description, pattern)))
) |>
filter(!is.na(adjective))
# Plot the frequency of each adjective
wine_with_adj |> group_by(adjective) |>
summarise(count = n()) |>
ggplot(aes(count, fct_reorder(adjective, count, .desc = TRUE),
fill = adjective)) +
geom_col(color = "black", width = 0.8, show.legend = FALSE) +
labs(
title = "Adjective frequency",
y = "Number of reviews",
x = NULL
) +
theme_minimal()
# Plot the frequency of each adjective
wine_with_adj |> group_by(adjective) |>
summarise(count = n()) |>
ggplot(aes(count, fct_reorder(adjective, count, .desc = TRUE),
fill = adjective)) +
geom_col(color = "black", width = 0.8, show.legend = FALSE) +
labs(
title = "Adjective frequency",
y = NULL,
x = "Number of times mentioned"
) +
theme_minimal()
The clear winner is the word "opulent". Evidently, the most sophisticated wines
gc()
