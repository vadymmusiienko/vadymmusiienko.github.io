y = NULL) +
theme_minimal() +
xlim(c(0,.007)) +
ylim(c(0,.01))
setwd("Work/College/Data Science/")
clear
#| echo: false
library(tidyverse)
setwd("vadymmusiienko.github.io/")
library(tidyverse)
wine_data <- read_csv("data/winemag-data_first150k.csv")
View(wine_data)
library(tidyverse)
wine_data <- read_csv("data/winemag-data_first150k.csv")
head(wine_data)
glimpse(wine_data)
country_ranking
country_ranking <- wine_data |>
group_by(country) |>
summarize(mean(points))
country_ranking
country_ranking <- wine_data |>
group_by(country) |>
summarize(avr_points = mean(points))
arrange(country_ranking, desc(avr_points))
wine_data |>
ggplot(aes(price, points)) +
geom_point() +
geom_abline()
wine_data |>
ggplot(aes(price, points)) +
geom_abline()
wine_data |>
ggplot(aes(price, points)) +
geom_histogram()
wine_data |>
ggplot(aes(price, points)) +
geom_bar()
wine_data |>
ggplot(aes(price, points)) +
geom_boxplot()
wine_data |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, points)) +
geom_boxplot()
wine_data |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_boxplot()
wine_data |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_point() +
geom_abline()
?is.na()
wine_data |>
filter(!is.na(price) & !is.na(points))
wine_data |>
filter(!is.na(price) & !is.na(points))
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_point() +
geom_abline()
wine_data |>
filter(!is.na(price) & !is.na(points))
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_point() +
geom_abline()
wine_data |>
filter(!is.na(price) & !is.na(points))
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_point() +
geom_abline()
wine_data |>
filter(!is.na(price) & !is.na(points))
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_point() +
geom_abline()
wine_data |>
filter(!is.na(price) & !is.na(points))
group_by(price) |>
summarize(avr_rating = mean(points))
wine_data |>
filter(!is.na(price) & !is.na(points))
wine_data |>
filter(!is.na(price) & !is.na(points))
wine_data
wine_data |>
filter(!is.na(price) & !is.na(points))
wine_data |>
filter(!is.na(price) & !is.na(points))
group_by(price) |>
summarize(avr_rating = mean(points))
wine_data |>
filter(!is.na(price) & !is.na(points))
group_by(price)
wine_data |>
filter(!is.na(price) & !is.na(points)) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_point() +
geom_abline()
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 1000) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_point() +
geom_abline()
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_point() +
geom_abline()
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_point()
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_abline() +
geom_point()
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_abline()
```{r}
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_abline() +
geom_point()
?geom_abline
wine_data |>
filter(price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_abline() +
geom_point()
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_abline() +
geom_point()
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_abline(intercept = 0) +
geom_point()
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_abline(intercept = 0) +
geom_point()
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_abline(intercept = -10) +
geom_point()
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_abline(intercept = -100) +
geom_point()
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_abline(intercept = 100) +
geom_point()
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_abline(intercept = 10) +
geom_point()
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_abline(intercept = 10) +
geom_point()
?xlim
?xlim()
?xlim()
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_abline() +
geom_point() +
xlim(0, 100) +
ylim(0, 100)
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_abline() +
geom_point() +
xlim(0, 100)
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_abline() +
geom_point() +
ylim(80, 100)
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_abline() +
geom_point() +
```
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_abline() +
geom_point()
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_point()
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_point(color = "red")
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_point(color = "red", alpha(0.5))
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_point(color = "red", alpha=0.5)
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_point(color = "red", alpha=0.5) +
geom_line()
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_point(color = "red", alpha=0.5) +
geom_line() +
geom_jitter()
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_point(color = "red", alpha=0.5) +
geom_jitter()
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_jitter()
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_point(color = "red", alpha=0.5) +
geom_line() +
geom_smooth()
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_point(color = "red", alpha=0.5) +
geom_smooth()
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_point(color = "red", alpha=0.5) +
geom_smooth(se = FALSE)
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_smooth(se = FALSE)
)
)
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_point(color = "red", alpha=0.5) +
geom_smooth()
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_point(, alpha=0.5) +
geom_smooth()
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_point(alpha=0.5) +
geom_smooth()
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_point() +
geom_smooth()
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_point() +
geom_smooth(color = "red")
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_point(alpha = 0.7) +
geom_smooth(color = "red")
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_smooth(color = "red") +
geom_point(alpha = 0.7)
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 100) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_point(alpha = 0.5) +
geom_smooth(color = "red")
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 50) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_point(alpha = 0.5) +
geom_smooth(color = "red")
wine_data |>
filter(!is.na(price) & !is.na(points)) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_point(alpha = 0.5) +
geom_smooth(color = "red")
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 500) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_point(alpha = 0.5) +
geom_smooth(color = "red")
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 500) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_point(alpha = 0.5) +
geom_smooth(color = "red") +
theme_minimal()
arrange(province_ranking, desc(avr_points))
province_ranking <- wine_data |>
group_by(province) |>
summarize(avr_points = mean(points))
arrange(province_ranking, desc(avr_points))
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 500) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_point(alpha = 0.5) +
geom_smooth(color = "red") +
theme_minimal()
winery_ranking <- wine_data |>
group_by(winery) |>
summarize(avr_points = mean(points))
arrange(winery_ranking, desc(avr_points))
winery_ranking <- wine_data |>
group_by(winery) |>
summarize(avr_points = mean(points), count = n())
arrange(winery_ranking, desc(avr_points))
winery_ranking <- wine_data |>
group_by(winery) |>
summarize(avr_points = mean(points), count = n()) |>
fileter(count > 10)
winery_ranking <- wine_data |>
group_by(winery) |>
summarize(avr_points = mean(points), count = n()) |>
fileter(count > 10)
winery_ranking <- wine_data |>
group_by(winery) |>
summarize(avr_points = mean(points), count = n()) |>
filter(count > 10)
winery_ranking <- wine_data |>
group_by(winery) |>
summarize(avr_points = mean(points), count = n()) |>
filter(count > 10)
arrange(winery_ranking, desc(avr_points))
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 500) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_point(alpha = 0.5) +
geom_smooth(color = "red") +
theme_minimal() +
geom_violin()
wine_data |>
filter(!is.na(price) & !is.na(points) & price < 500) |>
group_by(price) |>
summarize(avr_rating = mean(points)) |>
ggplot(aes(price, avr_rating)) +
geom_point(alpha = 0.5) +
geom_smooth(color = "red") +
theme_minimal()
?unnest_tokens
?unnest_auto
?strsplit
word_count <- wine_data |>
mutate(strsplit(description))
word_count <- wine_data |>
mutate(strsplit(description, " "))
word_count
word_count <- wine_data |>
summarize(strsplit(description, " "))
word_count
View(word_count)
word_count <- wine_data |>
summarize(words = strsplit(description, " "))
word_count |>
unnest(words) |>
count(words, name = "count") |>
arrange(desc(count))
wine_data
wine_data |> filter(str_detect(designation, "Red"))
wine_data |> filter(str_detect(designation, "Red "))
wine_data |> filter(str_detect(designation, "Red wine"))
wine_data |> filter(str_detect(designation, "Red wine"))
wine_data |> filter(str_detect(designation, "Red Wine"))
wine_data |> filter(str_detect(designation, "White Wine"))
wine_data <- wine_data |> filter(!(is.na(price) || is.na(country)))
wine_data <- wine_data |> filter(!(is.na(price) | is.na(country)))
wine_data <- wine_data |> filter(!(is.na(price) | is.na(country)))
wine_data
